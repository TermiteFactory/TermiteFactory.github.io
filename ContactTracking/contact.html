<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.2.2/jquery.form.min.js" integrity="sha384-FzT3vTVGXqf7wRfy8k4BiyzvbNfeYjK+frTVqZeNDFl8woCbF0CYG6g2fMEFFo/i" crossorigin="anonymous"></script>
<script type="text/javascript" src="sisyphus-mod.min.js"></script>
<script>
var deny1 = 0;
var deny2 = 0;
var deny3 = 0;
var deny4 = 0;
var deny5 = 0;
var deny6 = 0;
$( function() {
$( "#contact_form" ).sisyphus( {
    timeout: 0,
    autoRelease: false,
    occludeFields: $( "#Phone" ),
    excludeFields: $( "#q1_yes,#q1_no,#q2_yes,#q2_no,#q3_yes,#q3_no,#q4_yes,#q4_no,#q5_yes,#q5_no,#q6_yes,#q6_no,#q7_yes,#q7_no,#q8_yes,#q8_no,#q9_yes,#q9_no,#LastUpdate" ),
    }); //Autosave form2 only,
} );
$( function() {

$("#q1_yes").change(function() {
  if ($(this).val() == "Yes") {
    $('#Deny1').removeAttr('hidden');
    $('#SubmitButton').attr('disabled', '');
    deny1 = 1;
  } 
  });
$("#q1_no").change(function() {
  if ($(this).val() == "No") {
    $('#Deny1').attr('hidden', '');
    deny1 = 0;
    if (deny1 + deny2 + deny3 + deny4 + deny5 + deny6 === 0) {
        $('#SubmitButton').removeAttr('disabled');
    }
  } 
  });

$("#q2_yes").change(function() {
  if ($(this).val() == "Yes") {
    $('#Deny2').removeAttr('hidden');
    $('#SubmitButton').attr('disabled', '');
    deny2 = 1;
  } 
  });
$("#q2_no").change(function() {
  if ($(this).val() == "No") {
    $('#Deny2').attr('hidden', '');
    deny2 = 0;
    if (deny1 + deny2 + deny3 + deny4 + deny5 + deny6 === 0) {
        $('#SubmitButton').removeAttr('disabled');
    }
  } 
  });

$("#q3_yes").change(function() {
  if ($(this).val() == "Yes") {
    $('#Deny3').removeAttr('hidden');
    $('#SubmitButton').attr('disabled', '');
    deny3 = 1;
  } 
  });
$("#q3_no").change(function() {
  if ($(this).val() == "No") {
    $('#Deny3').attr('hidden', '');
    deny3 = 0;
    if (deny1 + deny2 + deny3 + deny4 + deny5 + deny6 === 0) {
        $('#SubmitButton').removeAttr('disabled');
    }
  } 
  });

$("#q4_yes").change(function() {
  if ($(this).val() == "Yes") {
    $('#Deny4').removeAttr('hidden');
    $('#SubmitButton').attr('disabled', '');
    deny4 = 1;
  } 
  });
$("#q4_no").change(function() {
  if ($(this).val() == "No") {
    $('#Deny4').attr('hidden', '');
    deny4 = 0;
    if (deny1 + deny2 + deny3 + deny4 + deny5 + deny6 === 0) {
        $('#SubmitButton').removeAttr('disabled');
    }
  } 
  });

$("#q5_yes").change(function() {
  if ($(this).val() == "Yes") {
    $('#Deny5').removeAttr('hidden');
    $('#SubmitButton').attr('disabled', '');
    deny5 = 1;
  } 
  });
$("#q5_no").change(function() {
  if ($(this).val() == "No") {
    $('#Deny5').attr('hidden', '');
    deny5 = 0;
    if (deny1 + deny2 + deny3 + deny4 + deny5 + deny6 === 0) {
        $('#SubmitButton').removeAttr('disabled');
    }
  } 
  });

$("#q6_yes").change(function() {
  if ($(this).val() == "Yes") {
    $('#Deny6').removeAttr('hidden');
    $('#SubmitButton').attr('disabled', '');
    deny6 = 1;
  } 
  });
$("#q6_no").change(function() {
  if ($(this).val() == "No") {
    $('#Deny6').attr('hidden', '');
    deny6 = 0;
    if (deny1 + deny2 + deny3 + deny4 + deny5 + deny6 === 0) {
        $('#SubmitButton').removeAttr('disabled');
    }
  } 
  });


$("#q7_yes").change(function() {
  if ($(this).val() == "Yes") {
    $('#Mask7').removeAttr('hidden');
  } 
  });
$("#q7_no").change(function() {
  if ($(this).val() == "No") {
    $('#Mask7').attr('hidden', '');
  } 
  });

  $("#q8_yes").change(function() {
  if ($(this).val() == "Yes") {
    $('#Mask8').removeAttr('hidden');
  } 
  });
$("#q8_no").change(function() {
  if ($(this).val() == "No") {
    $('#Mask8').attr('hidden', '');
  } 
  });

  $("#q9_yes").change(function() {
  if ($(this).val() == "Yes") {
    $('#Mask9').removeAttr('hidden');
  } 
  });
$("#q9_no").change(function() {
  if ($(this).val() == "No") {
    $('#Mask9').attr('hidden', '');
  } 
  });

if (!!window.performance && window.performance.navigation.type === 2) {
    // value 2 means "The page was accessed by navigating into the history"
    console.log('Reloading');
    window.location.reload(); // reload whole page
}

window.onpageshow = function (event) {
    if (event.persisted) {
        window.location.reload();
    }
};

$("#ClearPhone").click(function() {
    $('#Phone').val('');
    $('#Phone').removeAttr('readonly');
  });
$("#ClearName").click(function() {
    $('#Name').val('');
  });
} );
</script>
<script>
function getUrlVars()
{
    var vars = [], hash;
    var arguments = window.location.href.slice(window.location.href.indexOf('?') + 1)
    if (arguments.indexOf('#')!=-1) {
        arguments = arguments.slice(0, arguments.indexOf('#'));
    }
    var hashes = arguments.split('&');

    for(var i = 0; i < hashes.length; i++)
        {
         hash = hashes[i].split('=');
         vars[hash[0]] = hash[1];
         }

     return vars;
}
window.onload = function() {
    var get_vars = getUrlVars();
    for (var key in get_vars) {
        document.getElementById(key).value = get_vars[key];
    }
}
</script>
<!-- Bootstrap core CSS -->
<link href="https://getbootstrap.com/docs/4.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<title>Charis Contact Tracing</title>
</head>
<body>

<div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
    <h1 class="h1">Charis MC Travel & Health Declaration Form</h1>
    <p class="lead">Enter your details below to submit them to the Charis Contact Tracing Registry</p>
    <p style="background-color: #ffc0cb" >Questionaire Updated: 29th Feb 2020</p>
</div>

<div class="container">
    <form id="contact_form" action="https://script.google.com/macros/s/AKfycbx5s2D2UsbfEL7vWGE11hNpRoSNL7Jyv3T3gq25gmDCM0Ff3NS-/exec" class="needs-validation" method="post" novalidate>
        <div class="form-group">
            <label for="Name">Name</label>
            <div class="input-group">
                <input type="text" class="form-control" id="Name" aria-describedby="nameHelp" name="entry.558351992" placeholder="Enter Your Name" required>
                <span class="input-group-btn">
                    <button class="btn btn-primary" type="button" id="ClearName">Clear</button>
                </span>
                <div class="invalid-feedback">
                    Please Enter your Name.
                </div>
            </div>
            <small id="nameHelp" class="form-text text-muted">Name will be AutoFilled Subsequently</small>
        </div>
        <div class="form-group">
            <label for="Phone">Contact Number</label>
            <div class="input-group">
                <input type="text" class="form-control" id="Phone" aria-describedby="phoneHelp" name="entry.647234706" placeholder="Enter Your Number" required>
                <span class="input-group-btn">
                    <button class="btn btn-primary" type="button" id="ClearPhone">Clear</button>
                </span>
                <div class="invalid-feedback">
                    Please Enter your Number.
                </div>
            </div>
            <small id="phoneHelp" class="form-text text-muted">Phone number will be AutoFilled Subsequently - Half the digits will replaced with asterisk for privacy</small>
        </div>
        <hr />
        <h1 class="h5">Please answer the following questions</h5>

        <div class="form-group">
            <label >Q1: Are you unwell, that is, do you have a fever, flu, cough, sore throat, diarrhoea?</label>
            <br>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q1:unwell" id="q1_yes" value="Yes" required>
                <label class="form-check-label" for="q1_yes">Yes</label>
                </div>
                <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q1:unwell" id="q1_no" value="No" required>
                <label class="form-check-label" for="q1_no">No</label>
                <div class="invalid-feedback">
                    &nbsp&nbsp&nbsp&nbspPlease Pick an Option.
                </div>
            </div>
            <div class="alert alert-danger" id="Deny1" hidden>
                <strong>Approach Usher</strong> 
                Please proceed to speak to an usher. You will not be able to continue this declaration.
            </div>
        </div>
        <hr />
        <div class="form-group">
            <label >Q2: Have you returned from Mainland China, Macau, Hong Kong, Daegu City or Cheongdo County (South Korea) in the past 14 days?</label>
            <br>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q2:return from china" id="q2_yes" value="Yes" required>
                <label class="form-check-label" for="q2_yes">Yes</label>
                </div>
                <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q2:return from china" id="q2_no" value="No" required>
                <label class="form-check-label" for="q2_no">No</label>
                <div class="invalid-feedback">
                    &nbsp&nbsp&nbsp&nbspPlease Pick an Option.
                </div>
            </div>
            <div class="alert alert-danger" id="Deny2" hidden>
                <strong>Approach Usher</strong> 
                Please proceed to speak to an usher. You will not be able to continue this declaration.
            </div>
        </div>
        <hr />
        <div class="form-group">
            <label >Q3: Have you been in close contact with any suspected or confirmed cases of COVID-19?</label>
            <br>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q3:contact with covid" id="q3_yes" value="Yes" required>
                <label class="form-check-label" for="q3_yes">Yes</label>
                </div>
                <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q3:contact with covid" id="q3_no" value="No" required>
                <label class="form-check-label" for="q3_no">No</label>
                <div class="invalid-feedback">
                    &nbsp&nbsp&nbsp&nbspPlease Pick an Option.
                </div>
            </div>
            <div class="alert alert-danger" id="Deny3" hidden>
                <strong>Approach Usher</strong> 
                Please proceed to speak to an usher. You will not be able to continue this declaration.
            </div>
        </div>
        <hr />
        <div class="form-group">
            <label >Q4: Have you live in the same house as someone on Home Quarantine Orders (HQO) or Stay at Home Notice (SHN)?</label>
            <br>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q4:same house HQO" id="q4_yes" value="Yes" required>
                <label class="form-check-label" for="q4_yes">Yes</label>
                </div>
                <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q4:same house HQO" id="q4_no" value="No" required>
                <label class="form-check-label" for="q4_no">No</label>
                <div class="invalid-feedback">
                    &nbsp&nbsp&nbsp&nbspPlease Pick an Option.
                </div>
            </div>
            <div class="alert alert-danger" id="Deny4" hidden>
                <strong>Approach Usher</strong> 
                Please proceed to speak to an usher. You will not be able to continue this declaration.
            </div>
        </div>
        <hr />
        <div class="form-group">
            <label >Q5: Are you been placed on Leave of Absence?</label>
            <br>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q5:leave of absence" id="q5_yes" value="Yes" required>
                <label class="form-check-label" for="q5_yes">Yes</label>
                </div>
                <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q5:leave of absence" id="q5_no" value="No" required>
                <label class="form-check-label" for="q5_no">No</label>
                <div class="invalid-feedback">
                    &nbsp&nbsp&nbsp&nbspPlease Pick an Option.
                </div>
            </div>
            <div class="alert alert-danger" id="Deny5" hidden>
                <strong>Approach Usher</strong> 
                Please proceed to speak to an usher. You will not be able to continue this declaration.
            </div>
        </div>
        <hr />
        <div class="form-group">
            <label >Q6: Have you been in any of the known local clusters in the past 14 days?</label>
            <br>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q6:local cluster" id="q6_yes" value="Yes" required>
                <label class="form-check-label" for="q6_yes">Yes</label>
                </div>
                <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q6:local cluster" id="q6_no" value="No" required>
                <label class="form-check-label" for="q6_no">No</label>
                <div class="invalid-feedback">
                    &nbsp&nbsp&nbsp&nbspPlease Pick an Option.
                </div>
            </div>
            <div class="alert alert-danger" id="Deny6" hidden>
                <strong>Approach Usher</strong> 
                Please proceed to speak to an usher. You will not be able to continue this declaration.
            </div>
        </div>
        <hr />
        <div class="form-group">
            <label >Q7: Have you come in close contact with any traveler who has recently returned from Mainland China, Macau, Hong Kong, Daegu City or Cheongdo County (South Korea)?</label>
            <br>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q7:contact china" id="q7_yes" value="Yes" required>
                <label class="form-check-label" for="q7_yes">Yes</label>
                </div>
                <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q7:contact china" id="q7_no" value="No" required>
                <label class="form-check-label" for="q7_no">No</label>
                <div class="invalid-feedback">
                    &nbsp&nbsp&nbsp&nbspPlease Pick an Option.
                </div>
            </div>
            <div class="alert alert-danger" id="Mask7" hidden>
                <strong>Mandatory</strong>
                Please wear a mask at all times! Please approach an usher for a mask if you need one
            </div>
        </div>
        <hr />
        <div class="form-group">
            <label >Q8: Have you come in close contact with anyone who is on Leave of Absence?</label>
            <br>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q8:contact loa" id="q8_yes" value="Yes" required>
                <label class="form-check-label" for="q8_yes">Yes</label>
                </div>
                <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q8:contact loa" id="q8_no" value="No" required>
                <label class="form-check-label" for="q8_no">No</label>
                <div class="invalid-feedback">
                    &nbsp&nbsp&nbsp&nbspPlease Pick an Option.
                </div>
            </div>
            <div class="alert alert-danger" id="Mask8" hidden>
                <strong>Mandatory</strong>
                Please wear a mask at all times! Please approach an usher for a mask if you need one
            </div>
        </div>
        <hr />
        <div class="form-group">
            <label >Q9: Are you recovering from sickness?</label>
            <br>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q9:recovering" id="q9_yes" value="Yes" required>
                <label class="form-check-label" for="q9_yes">Yes</label>
                </div>
                <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="q9:recovering" id="q9_no" value="No" required>
                <label class="form-check-label" for="q9_no">No</label>
                <div class="invalid-feedback">
                    &nbsp&nbsp&nbsp&nbspPlease Pick an Option.
                </div>
            </div>
            <div class="alert alert-danger" id="Mask9" hidden>
                <strong>Mandatory</strong>
                Please wear a mask at all times! Please approach an usher for a mask if you need one
            </div>
        </div>
        <hr />
        <div class="form-group">
            <label for="Location">Check-In Location</label>
            <input type="text" class="form-control" id="Location" aria-describedby="locaHelp" name="Location" readonly>
            <small id="locaHelp" class="form-text text-muted">Location is AutoFilled by QR Code</small>
        </div>
        <div class="form-check">
            <input type="checkbox" class="form-check-input" id="Pdpa" required>
            <div class="invalid-feedback">
                Please Check the Box to Accept the PDPA Clause.
            </div>
            <label class="form-check-label text-muted" for="Pdpa">By submitting your information here, you agree and consent to Charis Methodist Church to collect, use, disclose and share your personal data, for the purpose of contact tracing should there be a need to, due to the current COVID-19 situation. Charis Methodist Church respects personal data and privacy, and will not share such information with any third parties unless authorized to do so.</label>
        </div>
        <input type="hidden" id="LastUpdate" name="FormLastUpdated" value="29th Feb 2020">
        <br>
        <div id="sub-progress" class="alert alert-success" role="alert" hidden>
            Submission in Progress, Please Wait!
        </div>
        <button type="submit" id="SubmitButton" class="btn btn-primary btn-lg">Submit</button>
    </form>
    <br>
</div>

<script>
    // Example starter JavaScript for disabling form submissions if there are invalid fields
    (function() {
      'use strict';
      window.addEventListener('load', function() {
        // Fetch all the forms we want to apply custom Bootstrap validation styles to
        var forms = document.getElementsByClassName('needs-validation');
        // Loop over them and prevent submission
        var validation = Array.prototype.filter.call(forms, function(form) {
          form.addEventListener('submit', function(event) {
            if (form.checkValidity() === false) {
              event.preventDefault();
              event.stopPropagation();
            }
            form.classList.add('was-validated');
          }, false);
        });
      }, false);
    })();

    // prepare Options Object
    var options = {
        success: function() {
            function ordinal_suffix_of(i) {
                var j = i % 10,
                    k = i % 100;
                if (j == 1 && k != 11) {
                    return i + "st";
                }
                if (j == 2 && k != 12) {
                    return i + "nd";
                }
                if (j == 3 && k != 13) {
                    return i + "rd";
                }
                return i + "th";
            }
            var monthNames = [
                "Jan", "Feb", "Mar",
                "Apr", "May", "Jun", "Jul",
                "Aug", "Sep", "Oct",
                "Nov", "Dec"
            ];
            var date = new Date();
            var day = ordinal_suffix_of(date.getDate());
            var monthIndex = date.getMonth();

            window.location.replace(encodeURI("success.html?submitted-on=" + day + ' ' + monthNames[monthIndex] + ' ' + date.getHours() + ':' + date.getMinutes()));
        },
        beforeSubmit: function(arr, form, options) {
           var valid = form[0].checkValidity();
           if (valid) {
                $('#sub-progress').removeAttr('hidden');
           }
           return valid;
        },
        clearForm: true
    };


    // wait for the DOM to be loaded
    $(function() {
        // bind 'myForm' and provide a simple callback function
        $('#contact_form').ajaxForm(options);
    });
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

</body>
</html>